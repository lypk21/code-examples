{"remainingRequest":"/Users/liuyingping/Desktop/www/vue/shopping/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/liuyingping/Desktop/www/vue/shopping/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuyingping/Desktop/www/vue/shopping/node_modules/cube-ui/src/components/slide/slide.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuyingping/Desktop/www/vue/shopping/node_modules/cube-ui/src/components/slide/slide.vue","mtime":499162500000},{"path":"/Users/liuyingping/Desktop/www/vue/shopping/node_modules/cache-loader/dist/cjs.js","mtime":1578012874466},{"path":"/Users/liuyingping/Desktop/www/vue/shopping/node_modules/babel-loader/lib/index.js","mtime":1529635966000},{"path":"/Users/liuyingping/Desktop/www/vue/shopping/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.assign\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport CubeSlideItem from './slide-item.vue';\nimport BScroll from 'better-scroll';\nimport scrollMixin from '../../common/mixins/scroll';\nimport deprecatedMixin from '../../common/mixins/deprecated';\nvar COMPONENT_NAME = 'cube-slide';\nvar EVENT_CHANGE = 'change';\nvar EVENT_SELECT = 'click';\nvar EVENT_SCROLL_END = 'scroll-end';\nvar EVENT_SCROLL = 'scroll';\nvar DIRECTION_H = 'horizontal';\nvar DIRECTION_V = 'vertical';\nvar DEFAULT_OPTIONS = {\n  momentum: false,\n  click: true,\n  observeDOM: false,\n  bounce: false\n};\nexport default {\n  name: COMPONENT_NAME,\n  mixins: [scrollMixin, deprecatedMixin],\n  props: {\n    data: {\n      type: Array,\n      default: function _default() {\n        /* istanbul ignore next */\n        return [];\n      }\n    },\n    initialIndex: {\n      type: Number,\n      default: 0\n    },\n    loop: {\n      type: Boolean,\n      default: true\n    },\n    threshold: {\n      type: Number,\n      default: 0.3\n    },\n    speed: {\n      type: Number,\n      default: 400\n    },\n    autoPlay: {\n      type: Boolean,\n      default: true\n    },\n    interval: {\n      type: Number,\n      default: 4000\n    },\n    showDots: {\n      type: Boolean,\n      default: true\n    },\n    direction: {\n      type: String,\n      default: DIRECTION_H\n    },\n    // The props allowVertical, stopPropagation could be removed in next minor version.\n    allowVertical: {\n      type: Boolean,\n      default: undefined,\n      deprecated: {\n        replacedBy: 'options'\n      }\n    },\n    stopPropagation: {\n      type: Boolean,\n      default: undefined,\n      deprecated: {\n        replacedBy: 'options'\n      }\n    },\n    refreshResetCurrent: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data: function data() {\n    return {\n      dots: 0,\n      currentPageIndex: this.initialIndex || 0\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    this._dataWatchers = [];\n    var needRefreshProps = ['data', 'loop', 'autoPlay', 'options.eventPassthrough', 'threshold', 'speed', 'allowVertical'];\n    needRefreshProps.forEach(function (key) {\n      _this._dataWatchers.push(_this.$watch(key, function () {\n        // To fix the render bug when add items since loop.\n        if (key === 'data') {\n          _this._destroy();\n        }\n        /* istanbul ignore next */\n\n\n        _this.$nextTick(function () {\n          _this.refresh();\n        });\n      }));\n    });\n  },\n  watch: {\n    initialIndex: function initialIndex(newIndex) {\n      if (newIndex !== this.currentPageIndex) {\n        this.slide && this.slide.goToPage(newIndex);\n      }\n    }\n  },\n  methods: {\n    clickItem: function clickItem(item, index) {\n      /* istanbul ignore next */\n      this.$emit(EVENT_SELECT, item, index);\n    },\n    refresh: function refresh() {\n      /* istanbul ignore if */\n      if (this.slide === null) {\n        return;\n      }\n\n      this._destroy();\n\n      clearTimeout(this._timer);\n\n      if (this.slide && this.refreshResetCurrent) {\n        this.currentPageIndex = 0;\n      }\n\n      this._updateSlideDom();\n\n      if (this.showDots) {\n        this._initDots();\n      }\n\n      if (this.currentPageIndex >= this.dots.length) {\n        this.currentPageIndex = this.dots.length - 1;\n      }\n\n      this._initSlide();\n\n      if (this.autoPlay) {\n        this._play();\n      }\n    },\n    _destroy: function _destroy() {\n      this.slide && this.slide.destroy();\n    },\n    _refresh: function _refresh() {\n      this._updateSlideDom(true);\n\n      this.slide.refresh();\n    },\n    _updateSlideDom: function _updateSlideDom(isResize) {\n      this._setSlideStyle(isResize);\n    },\n    _setSlideStyle: function _setSlideStyle(isResize) {\n      this.children = this.$refs.slideGroup.children;\n      var target = this.direction === DIRECTION_H ? 'width' : 'height';\n      var allSize = 0;\n      var slideSize = this.$refs.slide[\"client\".concat(target[0].toUpperCase() + target.slice(1))];\n      var len = this.children.length;\n\n      for (var i = 0; i < len; i++) {\n        var child = this.children[i];\n        child.style[target] = slideSize + 'px';\n        allSize += slideSize;\n      }\n\n      if (this.loop && !isResize && len > 1) {\n        allSize += 2 * slideSize;\n      }\n\n      this.$refs.slideGroup.style[target] = allSize + 'px';\n    },\n    _initSlide: function _initSlide() {\n      var _this2 = this;\n\n      var eventPassthrough = this.direction === DIRECTION_H && this.allowVertical ? DIRECTION_V : '';\n      var options = Object.assign({}, DEFAULT_OPTIONS, {\n        scrollX: this.direction === DIRECTION_H,\n        scrollY: this.direction === DIRECTION_V,\n        eventPassthrough: eventPassthrough,\n        snap: {\n          loop: this.loop,\n          threshold: this.threshold,\n          speed: this.speed\n        },\n        stopPropagation: this.stopPropagation\n      }, this.options);\n      this.slide = new BScroll(this.$refs.slide, options);\n      this.slide.on('scrollEnd', this._onScrollEnd);\n      this.slide.goToPage(this.currentPageIndex, 0, 0);\n      /* dispatch scroll position constantly */\n\n      if (this.options.listenScroll && this.options.probeType === 3) {\n        this.slide.on('scroll', this._onScroll);\n      }\n\n      var slideEl = this.$refs.slide;\n      slideEl.removeEventListener('touchend', this._touchEndEvent, false);\n\n      this._touchEndEvent = function () {\n        if (_this2.autoPlay) {\n          _this2._play();\n        }\n      };\n\n      slideEl.addEventListener('touchend', this._touchEndEvent, false);\n      this.slide.on('beforeScrollStart', function () {\n        if (_this2.autoPlay) {\n          clearTimeout(_this2._timer);\n        }\n      });\n    },\n    _onScrollEnd: function _onScrollEnd() {\n      var _this$slide$getCurren = this.slide.getCurrentPage(),\n          pageX = _this$slide$getCurren.pageX,\n          pageY = _this$slide$getCurren.pageY;\n\n      var pageIndex = this.direction === DIRECTION_H ? pageX : pageY;\n\n      if (this.currentPageIndex !== pageIndex) {\n        this.currentPageIndex = pageIndex;\n        this.$emit(EVENT_CHANGE, pageIndex);\n      }\n\n      this.$emit(EVENT_SCROLL_END, pageIndex);\n\n      if (this.autoPlay) {\n        this._play();\n      }\n    },\n    _onScroll: function _onScroll(pos) {\n      this.$emit(EVENT_SCROLL, pos);\n    },\n    _initDots: function _initDots() {\n      this.dots = new Array(this.children.length);\n    },\n    _play: function _play() {\n      var _this3 = this;\n\n      clearTimeout(this._timer);\n      this._timer = setTimeout(function () {\n        _this3.slide.next();\n      }, this.interval);\n    },\n    _deactivated: function _deactivated() {\n      clearTimeout(this._timer);\n      clearTimeout(this._resizeTimer);\n      window.removeEventListener('resize', this._resizeHandler);\n      var slideEl = this.$refs.slide;\n\n      if (slideEl) {\n        slideEl.removeEventListener('touchend', this._touchEndEvent, false);\n      }\n    },\n    _resizeHandler: function _resizeHandler() {\n      var _this4 = this;\n\n      /* istanbul ignore if */\n      if (!this.slide) {\n        return;\n      }\n\n      clearTimeout(this._resizeTimer);\n      this._resizeTimer = setTimeout(function () {\n        /* istanbul ignore if */\n        if (_this4.slide.isInTransition) {\n          _this4._onScrollEnd();\n        } else {\n          if (_this4.autoPlay) {\n            _this4._play();\n          }\n        }\n\n        _this4._refresh();\n      }, 60);\n    }\n  },\n  mounted: function mounted() {\n    var _this5 = this;\n\n    this.$nextTick(function () {\n      _this5.refresh();\n    });\n    window.addEventListener('resize', this._resizeHandler);\n  },\n  activated: function activated() {\n    /* istanbul ignore next */\n    if (this.autoPlay) {\n      this._play();\n    }\n\n    window.addEventListener('resize', this._resizeHandler);\n  },\n  deactivated: function deactivated() {\n    /* istanbul ignore next */\n    this._deactivated();\n  },\n  destroyed: function destroyed() {\n    this._deactivated();\n\n    this._destroy();\n\n    this.slide = null;\n\n    this._dataWatchers.forEach(function (cancalWatcher) {\n      cancalWatcher();\n    });\n\n    this._dataWatchers = null;\n  },\n  components: {\n    CubeSlideItem: CubeSlideItem\n  }\n};",{"version":3,"sources":["slide.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"cube-slide\" ref=\"slide\">\n    <div class=\"cube-slide-group\" ref=\"slideGroup\">\n      <slot>\n        <cube-slide-item\n          v-for=\"(item, index) in data\"\n          :key=\"index\"\n          @click.native=\"clickItem(item, index)\"\n          :item=\"item\">\n        </cube-slide-item>\n      </slot>\n    </div>\n    <div class=\"cube-slide-dots\" v-if=\"showDots\">\n      <slot name=\"dots\" :current=\"currentPageIndex\" :dots=\"dots\">\n        <span :class=\"{active: currentPageIndex === index}\" v-for=\"(item, index) in dots\" :key=\"index\"></span>\n      </slot>\n    </div>\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\n  import CubeSlideItem from './slide-item.vue'\n  import BScroll from 'better-scroll'\n  import scrollMixin from '../../common/mixins/scroll'\n  import deprecatedMixin from '../../common/mixins/deprecated'\n\n  const COMPONENT_NAME = 'cube-slide'\n  const EVENT_CHANGE = 'change'\n  const EVENT_SELECT = 'click'\n  const EVENT_SCROLL_END = 'scroll-end'\n  const EVENT_SCROLL = 'scroll'\n\n  const DIRECTION_H = 'horizontal'\n  const DIRECTION_V = 'vertical'\n\n  const DEFAULT_OPTIONS = {\n    momentum: false,\n    click: true,\n    observeDOM: false,\n    bounce: false\n  }\n\n  export default {\n    name: COMPONENT_NAME,\n    mixins: [scrollMixin, deprecatedMixin],\n    props: {\n      data: {\n        type: Array,\n        default() {\n          /* istanbul ignore next */\n          return []\n        }\n      },\n      initialIndex: {\n        type: Number,\n        default: 0\n      },\n      loop: {\n        type: Boolean,\n        default: true\n      },\n      threshold: {\n        type: Number,\n        default: 0.3\n      },\n      speed: {\n        type: Number,\n        default: 400\n      },\n      autoPlay: {\n        type: Boolean,\n        default: true\n      },\n      interval: {\n        type: Number,\n        default: 4000\n      },\n      showDots: {\n        type: Boolean,\n        default: true\n      },\n      direction: {\n        type: String,\n        default: DIRECTION_H\n      },\n      // The props allowVertical, stopPropagation could be removed in next minor version.\n      allowVertical: {\n        type: Boolean,\n        default: undefined,\n        deprecated: {\n          replacedBy: 'options'\n        }\n      },\n      stopPropagation: {\n        type: Boolean,\n        default: undefined,\n        deprecated: {\n          replacedBy: 'options'\n        }\n      },\n      refreshResetCurrent: {\n        type: Boolean,\n        default: true\n      }\n    },\n    data() {\n      return {\n        dots: 0,\n        currentPageIndex: this.initialIndex || 0\n      }\n    },\n    created() {\n      this._dataWatchers = []\n      const needRefreshProps = ['data', 'loop', 'autoPlay', 'options.eventPassthrough', 'threshold', 'speed', 'allowVertical']\n      needRefreshProps.forEach((key) => {\n        this._dataWatchers.push(this.$watch(key, () => {\n          // To fix the render bug when add items since loop.\n          if (key === 'data') {\n            this._destroy()\n          }\n\n          /* istanbul ignore next */\n          this.$nextTick(() => {\n            this.refresh()\n          })\n        }))\n      })\n    },\n    watch: {\n      initialIndex(newIndex) {\n        if (newIndex !== this.currentPageIndex) {\n          this.slide && this.slide.goToPage(newIndex)\n        }\n      }\n    },\n    methods: {\n      clickItem(item, index) {\n        /* istanbul ignore next */\n        this.$emit(EVENT_SELECT, item, index)\n      },\n      refresh() {\n        /* istanbul ignore if */\n        if (this.slide === null) {\n          return\n        }\n        this._destroy()\n        clearTimeout(this._timer)\n\n        if (this.slide && this.refreshResetCurrent) {\n          this.currentPageIndex = 0\n        }\n        this._updateSlideDom()\n        if (this.showDots) {\n          this._initDots()\n        }\n        if (this.currentPageIndex >= this.dots.length) {\n          this.currentPageIndex = this.dots.length - 1\n        }\n        this._initSlide()\n\n        if (this.autoPlay) {\n          this._play()\n        }\n      },\n      _destroy() {\n        this.slide && this.slide.destroy()\n      },\n      _refresh() {\n        this._updateSlideDom(true)\n        this.slide.refresh()\n      },\n      _updateSlideDom(isResize) {\n        this._setSlideStyle(isResize)\n      },\n      _setSlideStyle(isResize) {\n        this.children = this.$refs.slideGroup.children\n\n        const target = this.direction === DIRECTION_H ? 'width' : 'height'\n        let allSize = 0\n        const slideSize = this.$refs.slide[`client${target[0].toUpperCase() + target.slice(1)}`]\n        const len = this.children.length\n        for (let i = 0; i < len; i++) {\n          const child = this.children[i]\n          child.style[target] = slideSize + 'px'\n          allSize += slideSize\n        }\n        if (this.loop && !isResize && len > 1) {\n          allSize += 2 * slideSize\n        }\n        this.$refs.slideGroup.style[target] = allSize + 'px'\n      },\n      _initSlide() {\n        const eventPassthrough = this.direction === DIRECTION_H && this.allowVertical ? DIRECTION_V : ''\n\n        const options = Object.assign({}, DEFAULT_OPTIONS, {\n          scrollX: this.direction === DIRECTION_H,\n          scrollY: this.direction === DIRECTION_V,\n          eventPassthrough,\n          snap: {\n            loop: this.loop,\n            threshold: this.threshold,\n            speed: this.speed\n          },\n          stopPropagation: this.stopPropagation\n        }, this.options)\n\n        this.slide = new BScroll(this.$refs.slide, options)\n\n        this.slide.on('scrollEnd', this._onScrollEnd)\n\n        this.slide.goToPage(this.currentPageIndex, 0, 0)\n\n        /* dispatch scroll position constantly */\n        if (this.options.listenScroll && this.options.probeType === 3) {\n          this.slide.on('scroll', this._onScroll)\n        }\n        const slideEl = this.$refs.slide\n        slideEl.removeEventListener('touchend', this._touchEndEvent, false)\n        this._touchEndEvent = () => {\n          if (this.autoPlay) {\n            this._play()\n          }\n        }\n        slideEl.addEventListener('touchend', this._touchEndEvent, false)\n\n        this.slide.on('beforeScrollStart', () => {\n          if (this.autoPlay) {\n            clearTimeout(this._timer)\n          }\n        })\n      },\n      _onScrollEnd() {\n        const { pageX, pageY } = this.slide.getCurrentPage()\n        let pageIndex = this.direction === DIRECTION_H ? pageX : pageY\n        if (this.currentPageIndex !== pageIndex) {\n          this.currentPageIndex = pageIndex\n          this.$emit(EVENT_CHANGE, pageIndex)\n        }\n\n        this.$emit(EVENT_SCROLL_END, pageIndex)\n\n        if (this.autoPlay) {\n          this._play()\n        }\n      },\n      _onScroll(pos) {\n        this.$emit(EVENT_SCROLL, pos)\n      },\n      _initDots() {\n        this.dots = new Array(this.children.length)\n      },\n      _play() {\n        clearTimeout(this._timer)\n        this._timer = setTimeout(() => {\n          this.slide.next()\n        }, this.interval)\n      },\n      _deactivated() {\n        clearTimeout(this._timer)\n        clearTimeout(this._resizeTimer)\n        window.removeEventListener('resize', this._resizeHandler)\n        const slideEl = this.$refs.slide\n        if (slideEl) {\n          slideEl.removeEventListener('touchend', this._touchEndEvent, false)\n        }\n      },\n      _resizeHandler() {\n        /* istanbul ignore if */\n        if (!this.slide) {\n          return\n        }\n        clearTimeout(this._resizeTimer)\n        this._resizeTimer = setTimeout(() => {\n          /* istanbul ignore if */\n          if (this.slide.isInTransition) {\n            this._onScrollEnd()\n          } else {\n            if (this.autoPlay) {\n              this._play()\n            }\n          }\n          this._refresh()\n        }, 60)\n      }\n    },\n    mounted() {\n      this.$nextTick(() => {\n        this.refresh()\n      })\n\n      window.addEventListener('resize', this._resizeHandler)\n    },\n    activated() {\n      /* istanbul ignore next */\n      if (this.autoPlay) {\n        this._play()\n      }\n      window.addEventListener('resize', this._resizeHandler)\n    },\n    deactivated() {\n      /* istanbul ignore next */\n      this._deactivated()\n    },\n    destroyed() {\n      this._deactivated()\n      this._destroy()\n      this.slide = null\n\n      this._dataWatchers.forEach((cancalWatcher) => {\n        cancalWatcher()\n      })\n      this._dataWatchers = null\n    },\n    components: {\n      CubeSlideItem\n    }\n  }\n</script>\n\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n  @require \"../../common/stylus/variable.styl\"\n  .cube-slide\n    position: relative\n    min-height: 1px\n    height: 100%\n    overflow: hidden\n\n  .cube-slide-group\n    position: relative\n    height: 100%\n    overflow: hidden\n    white-space: nowrap\n\n  .cube-slide-dots\n    position: absolute\n    bottom: 2px\n    right: 0\n    left: 0\n    padding: 0 6px\n    font-size: 0\n    text-align: center\n    transform: translateZ(1px)\n    > span\n      display: inline-block\n      vertical-align: bottom\n      margin: 0 1px\n      width: 10px\n      height: 1px\n      background: $slide-dot-bgc\n      &.active\n        background: $slide-dot-active-bgc\n</style>\n"],"sourceRoot":"node_modules/cube-ui/src/components/slide"}]}